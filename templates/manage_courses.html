<!-- manage_courses.html -->
{% extends 'base_dash.html' %}
{% block title %} manage courses | Eduverse {% endblock %}
{% block content %}
  <section class="dashboard-card course-form" aria-labelledby="manage-title">
    <h2 id="manage-title" class="card-title">Manage Courses</h2>
                    <div class="flash-messages">
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        {% for category, message in messages %}
            <div class="alert alert-{{category}}" role="alert">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}
    {% endwith %}
    {% if courses %}
      {% for course in courses %}
      <article class="course-card">
        {% if course.image_path %}
        <img src="{{ url_for('static', filename=course.image_path) }}" alt="{{ course.title }} thumbnail" class="course-thumbnail">
        {% endif %}

        <h3 class="course-title">{{ course.title }}</h3>
        <p class="card-text">{{ course.description }}</p>

        <form method="POST" enctype="multipart/form-data" action="{{ url_for('manage_courses') }}">
          <input type="hidden" name="course_id" value="{{ course.id }}">

          <div class="form-group">
            <label for="title{{ course.id }}" class="form-label">Course Title</label>
            <input type="text" id="title{{ course.id }}" name="title" class="form-control" value="{{ course.title }}" required>
          </div>

          <div class="form-group">
            <label for="description{{ course.id }}" class="form-label">Description</label>
            <textarea id="description{{ course.id }}" name="description" class="form-control" rows="4">{{ course.description }}</textarea>
          </div>

          <div class="form-group">
            <label for="image{{ course.id }}" class="form-label">Course Thumbnail</label>
            <input type="file" id="image{{ course.id }}" name="image" class="form-control" accept="image/*">
          </div>

          <div class="form-group">
            <label for="video{{ course.id }}" class="form-label">Course Video</label>
            <input type="file" id="video{{ course.id }}" name="video" class="form-control" accept="video/mp4,video/webm">
          </div>

          <div class="form-group">
            <label for="topics{{ course.id }}" class="form-label">Topics (comma-separated)</label>
            <input type="text" id="topics{{ course.id }}" name="topics" class="form-control" value="{{ course.topics }}">
          </div>

          <div class="course-actions">
            <button type="submit" class="btn btn-primary">Update</button>
            <button type="submit" name="delete_course" value="{{ course.id }}" class="btn btn-danger"
              onclick="function confirm(areYouSureYouWantToDeleteThisCourse) {
              return undefined;
              }
              return confirm('Are you sure you want to delete this course?');">
              Delete
            </button>
          </div>
        </form>
      </article>
      {% endfor %}
    {% else %}
      <p>No courses available. <a href="{{ url_for('create_course') }}">Create a new course</a>.</p>
    {% endif %}
  </section>
{% endblock %}
